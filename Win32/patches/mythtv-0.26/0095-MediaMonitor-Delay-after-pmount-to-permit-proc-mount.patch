From ff2790cf5e899ec076cf767af05e17eff27c1390 Mon Sep 17 00:00:00 2001
From: Lawrence Rust <lvr@softsystem.co.uk>
Date: Thu, 7 Jun 2012 11:34:47 +0200
Subject: [PATCH 095/227] MediaMonitor: Delay after pmount to permit
 /proc/mounts to update

Derived from 7dbf91c (myfixes-0.24)

Signed-off-by: Lawrence Rust <lvr@softsystem.co.uk>
---
 mythtv/libs/libmythbase/mythmedia.cpp |    4 ++++
 1 file changed, 4 insertions(+)

diff --git a/mythtv/libs/libmythbase/mythmedia.cpp b/mythtv/libs/libmythbase/mythmedia.cpp
index 56ef235..b8a1210 100644
--- a/mythtv/libs/libmythbase/mythmedia.cpp
+++ b/mythtv/libs/libmythbase/mythmedia.cpp
@@ -147,6 +147,10 @@ bool MythMediaDevice::performMountCmd(bool DoMount)
             {
                 // we cannot tell beforehand what the pmount mount point is
                 // so verify the mount status of the device
+                // In the case that m_DevicePath is a symlink to a device
+                // in /etc/fstab then pmount delegates to mount which
+                // performs the mount asynchronously so we must wait a bit
+                usleep(1000000);
                 if (!findMountPath())
                 {
                     LOG(VB_MEDIA, LOG_ERR, "performMountCmd() attempted to"
-- 
1.7.9.5

