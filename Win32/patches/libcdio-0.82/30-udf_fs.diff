--- libcdio-0.82-orig/lib/udf/udf_fs.c	2008-11-29 04:52:43.000000000 +0000
+++ libcdio-0.82/lib/udf/udf_fs.c	2013-08-09 18:25:12.000000000 +0100
@@ -222,7 +222,7 @@ udf_ff_traverse(udf_dirent_t *p_udf_dire
       }
     }
   }
-  free(p_udf_dirent->psz_name);
+//  free(p_udf_dirent->psz_name);
   return NULL;
 }
 
@@ -250,7 +250,8 @@ udf_fopen(udf_dirent_t *p_udf_root, cons
 		       p_udf_root->psz_name, p_udf_root->b_dir, 
 		       p_udf_root->b_parent);
       p_udf_file = udf_ff_traverse(p_udf_dirent, psz_token);
-      udf_dirent_free(p_udf_dirent);
+      if (p_udf_file)
+        udf_dirent_free(p_udf_dirent);
     }
     else if ( 0 == strncmp("/", psz_name, sizeof("/")) ) {
       return udf_new_dirent(&p_udf_root->fe, p_udf_root->p_udf,
