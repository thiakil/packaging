From 287b31f0b49c60295a5b349214514fb4ebccb3ce Mon Sep 17 00:00:00 2001
From: Lawrence Rust <lvr@softsystem.co.uk>
Date: Tue, 12 Feb 2013 17:34:12 +0000
Subject: [PATCH 058/207] mythtranscode: Prevent a divide by 0 exception

Signed-off-by: Lawrence Rust <lvr@softsystem.co.uk>
---
 .../programs/mythtranscode/audioreencodebuffer.cpp |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/mythtv/programs/mythtranscode/audioreencodebuffer.cpp b/mythtv/programs/mythtranscode/audioreencodebuffer.cpp
index 5cae97a..2930085 100644
--- a/mythtv/programs/mythtranscode/audioreencodebuffer.cpp
+++ b/mythtv/programs/mythtranscode/audioreencodebuffer.cpp
@@ -167,7 +167,8 @@ bool AudioReencodeBuffer::AddData(void *buffer, int len, int64_t timecode,
         // and use 'frames' directly rather than 'len / m_bytes_per_frame',
         // thus also covering the passthrough case.
         m_saveBuffer = new AudioBuffer();
-        timecode += frames * 1000 / m_eff_audiorate;
+        if (m_eff_audiorate)
+            timecode += frames * 1000 / m_eff_audiorate;
         m_saveBuffer->appendData(buf, len, frames, timecode);
 
         QMutexLocker locker(&m_bufferMutex);
-- 
1.7.9.5

