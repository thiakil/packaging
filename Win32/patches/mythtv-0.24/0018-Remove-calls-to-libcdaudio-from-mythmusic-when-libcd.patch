From b5ec14f760605f8c5c92ce14523360352e31b773 Mon Sep 17 00:00:00 2001
From: Lawrence Rust <lvr@softsystem.co.uk>
Date: Fri, 1 Apr 2011 18:45:37 +0200
Subject: [PATCH 018/285] Remove calls to libcdaudio from mythmusic when
 libcdio is used

---
 mythplugins/mythmusic/mythmusic/main.cpp |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/mythplugins/mythmusic/mythmusic/main.cpp b/mythplugins/mythmusic/mythmusic/main.cpp
index 609eaf9..0d24ff0 100644
--- a/mythplugins/mythmusic/mythmusic/main.cpp
+++ b/mythplugins/mythmusic/mythmusic/main.cpp
@@ -62,6 +62,7 @@ static QString chooseCD(void)
 
 static void CheckFreeDBServerFile(void)
 {
+#if defined HAVE_CDAUDIO && !defined HAVE_CDIO
     QString homeDir = QDir::home().path();
 
     if (homeDir.isEmpty())
@@ -75,7 +76,6 @@ static void CheckFreeDBServerFile(void)
 
     if (!file.exists())
     {
-#ifdef HAVE_CDAUDIO
         struct cddb_conf cddbconf;
         struct cddb_serverlist list;
         struct cddb_host proxy_host;
@@ -91,8 +91,8 @@ static void CheckFreeDBServerFile(void)
         list.list_host[0].host_protocol = CDDB_MODE_HTTP;
 
         cddb_write_serverlist(cddbconf, list, proxy_host.host_server);
-#endif
     }
+#endif
 }
 
 static void SavePending(int pending)
-- 
1.7.9.5

