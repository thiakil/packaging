From cb833601b53fa765dd9c05f6cac65feb3f410b0a Mon Sep 17 00:00:00 2001
From: Lawrence Rust <lvr@softsystem.co.uk>
Date: Wed, 12 Jun 2013 14:55:08 +0100
Subject: [PATCH 198/285] MythPlayer: Clear EOF when resuming play

RingBuffer::Read returns 0 (eof) when the buffer is paused.  This causes
ffmpeg to set eof and prevent any further reads by the decoder.

This patch clears the decoder's eof on restarting play which in turn
resets ffmpeg's eof.

Signed-off-by: Lawrence Rust <lvr@softsystem.co.uk>
---
 mythtv/libs/libmythtv/mythplayer.cpp |    3 +++
 1 file changed, 3 insertions(+)

diff --git a/mythtv/libs/libmythtv/mythplayer.cpp b/mythtv/libs/libmythtv/mythplayer.cpp
index d2f51bd..bc7c136 100644
--- a/mythtv/libs/libmythtv/mythplayer.cpp
+++ b/mythtv/libs/libmythtv/mythplayer.cpp
@@ -341,6 +341,8 @@ bool MythPlayer::Pause(void)
     PauseVideo();
     audio.Pause(true);
     PauseBuffer();
+    if (!decoderPaused)
+        PauseDecoder(); // Retry in case audio only stream
     allpaused = decoderPaused && videoPaused && bufferPaused;
     {
         if (using_null_videoout && decoder)
@@ -365,6 +367,7 @@ bool MythPlayer::Play(float speed, bool normal, bool unpauseaudio)
         return false;
     }
 
+    SetEof(false);
     UnpauseBuffer();
     if (unpauseaudio)
         audio.Pause(false);
-- 
1.7.9.5

