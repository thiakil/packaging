From 69787fa62b6c4223f6fb1d594cf8209ab30236f1 Mon Sep 17 00:00:00 2001
From: Lawrence Rust <lvr@softsystem.co.uk>
Date: Sun, 30 Jan 2011 12:32:47 -0800
Subject: [PATCH 028/285] Make mythgallery's thumb generator not auto-detect

The QImageReader autodetection seems to be overkill for what we need here.  By
turning this off, only registered image extensions will be tried.  This will
significantly speed up scanning directories with mixed content in them.

Hopefully, this will not adversely affect "normal" directories of only images.

Fixes #9523

Signed-off-by: Gavin Hurlbut <ghurlbut@mythtv.org>
(cherry picked from commit d1ab62dc3dee829e75dd649b36adc875ca06643a)

Signed-off-by: Lawrence Rust <lvr@softsystem.co.uk>
---
 .../mythgallery/mythgallery/thumbgenerator.cpp     |    1 +
 1 file changed, 1 insertion(+)

diff --git a/mythplugins/mythgallery/mythgallery/thumbgenerator.cpp b/mythplugins/mythgallery/mythgallery/thumbgenerator.cpp
index 7a94f50..adcfc5e 100644
--- a/mythplugins/mythgallery/mythgallery/thumbgenerator.cpp
+++ b/mythplugins/mythgallery/mythgallery/thumbgenerator.cpp
@@ -241,6 +241,7 @@ void ThumbGenerator::loadDir(QImage& image, const QFileInfo& fi)
     {
         f = &(*it);
         QImageReader testread(f->absoluteFilePath());
+        testread.setAutoDetectImageFormat(false);
         if (testread.canRead())
         {
             found = true;
-- 
1.7.9.5

