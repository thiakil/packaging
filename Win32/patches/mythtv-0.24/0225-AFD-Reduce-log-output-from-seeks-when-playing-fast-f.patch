From 781d7f17dbcfda975790e051d1d13f1fd8794e65 Mon Sep 17 00:00:00 2001
From: Lawrence Rust <lvr@softsystem.co.uk>
Date: Mon, 17 Jun 2013 15:03:12 +0100
Subject: [PATCH 225/285] AFD: Reduce log output from seeks when playing fast
 forward

Signed-off-by: Lawrence Rust <lvr@softsystem.co.uk>
---
 mythtv/libs/libmythtv/avformatdecoder.cpp |   16 ++++++++--------
 mythtv/libs/libmythtv/decoderbase.cpp     |    4 ++--
 2 files changed, 10 insertions(+), 10 deletions(-)

diff --git a/mythtv/libs/libmythtv/avformatdecoder.cpp b/mythtv/libs/libmythtv/avformatdecoder.cpp
index b225584..19e168f 100644
--- a/mythtv/libs/libmythtv/avformatdecoder.cpp
+++ b/mythtv/libs/libmythtv/avformatdecoder.cpp
@@ -523,13 +523,13 @@ long long AvFormatDecoder::GetChapter(int chapter)
 
 bool AvFormatDecoder::DoRewind(long long desiredFrame, bool discardFrames)
 {
+    if (recordingHasPositionMap || livetv)
+        return DecoderBase::DoRewind(desiredFrame, discardFrames);
+
     VERBOSE(VB_PLAYBACK, LOC + "DoRewind("
             <<desiredFrame<<", "
             <<( discardFrames ? "do" : "don't" )<<" discard frames)");
 
-    if (recordingHasPositionMap || livetv)
-        return DecoderBase::DoRewind(desiredFrame, discardFrames);
-
     dorewind = true;
 
     // avformat-based seeking
@@ -538,14 +538,14 @@ bool AvFormatDecoder::DoRewind(long long desiredFrame, bool discardFrames)
 
 bool AvFormatDecoder::DoFastForward(long long desiredFrame, bool discardFrames)
 {
+    if (recordingHasPositionMap || livetv)
+        return DecoderBase::DoFastForward(desiredFrame, discardFrames);
+
     VERBOSE(VB_PLAYBACK, LOC +
             QString("DoFastForward(%1 (%2), %3 discard frames)")
             .arg(desiredFrame).arg(framesPlayed)
             .arg((discardFrames) ? "do" : "don't"));
 
-    if (recordingHasPositionMap || livetv)
-        return DecoderBase::DoFastForward(desiredFrame, discardFrames);
-
     bool oldrawstate = getrawframes;
     getrawframes = false;
 
@@ -668,7 +668,7 @@ void AvFormatDecoder::SeekReset(long long newKey, uint skipFrames,
             return;
     }
 
-    VERBOSE(VB_PLAYBACK, LOC +
+    VERBOSE(VB_PLAYBACK|VB_EXTRA, LOC +
             QString("SeekReset(%1, %2, %3 flush, %4 discard)")
             .arg(newKey).arg(skipFrames)
             .arg((doflush) ? "do" : "don't")
@@ -700,7 +700,7 @@ void AvFormatDecoder::SeekReset(long long newKey, uint skipFrames,
         }
 
         // Flush the avcodec buffers
-        VERBOSE(VB_PLAYBACK, LOC + "SeekReset() flushing");
+        VERBOSE(VB_PLAYBACK|VB_EXTRA, LOC + "SeekReset() flushing");
         for (uint i = 0; i < ic->nb_streams; i++)
         {
             AVCodecContext *enc = ic->streams[i]->codec;
diff --git a/mythtv/libs/libmythtv/decoderbase.cpp b/mythtv/libs/libmythtv/decoderbase.cpp
index a6b3efa..b63e3e1 100644
--- a/mythtv/libs/libmythtv/decoderbase.cpp
+++ b/mythtv/libs/libmythtv/decoderbase.cpp
@@ -397,7 +397,7 @@ bool DecoderBase::FindPosition(long long desired_value, bool search_adjusted,
             upper_bound = i;
             lower_bound = i;
 
-            VERBOSE(VB_PLAYBACK, LOC +
+            VERBOSE(VB_PLAYBACK|VB_EXTRA, LOC +
                     QString("FindPosition(%1, search%2 adjusted)")
                     .arg(desired_value).arg((search_adjusted) ? "" : " not") +
                     QString(" --> [%1:%2(%3)]")
@@ -436,7 +436,7 @@ bool DecoderBase::FindPosition(long long desired_value, bool search_adjusted,
     upper_bound = upper;
     lower_bound = lower;
 
-    VERBOSE(VB_PLAYBACK, LOC +
+    VERBOSE(VB_PLAYBACK|VB_EXTRA, LOC +
             QString("FindPosition(%1, search%3 adjusted)")
             .arg(desired_value).arg((search_adjusted) ? "" : " not") +
             QString(" --> \n\t\t\t[%1:%2(%3),%4:%5(%6)]")
-- 
1.7.9.5

